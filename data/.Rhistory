if(month!="12") {
month=as.character(as.numeric(month)+1)
if(length(month)==1) month=paste0("0",month)
} else{
year=as.character(as.numeric(year)+1)
month="01"
}
if(length(s)>0){
mean.month[count]=mean(s)
} else{
mean.month[count]=0
}
s=numeric()
count=count+1
}
if(date[[1]][1]==year&date[[1]][2]==month){
if(is.na(aaa$PRCP[i])==F){
s=c(s,aaa$PRCP[i])
}
}
}
final1=data.frame(mean.month,year.1,month.1)
final1
for(i in 1:120){
date=strsplit(aaa$DATE[i],"-")
while((date[[1]][1]!=year) || (date[[1]][2]!=month)){
month.1[count]=month
year.1[count]=year
if(month!="12") {
month=as.character(as.numeric(month)+1)
if(length(month)==1) month=paste0("0",month)
} else{
year=as.character(as.numeric(year)+1)
month="01"
}
if(length(s)>0){
mean.month[count]=mean(s)
} else{
mean.month[count]=0
}
s=numeric()
count=count+1
}
if(date[[1]][1]==year&date[[1]][2]==month){
if(is.na(aaa$PRCP[i])==F){
s=c(s,aaa$PRCP[i])
}
}
}
aaa$DATE
nchar("12")
nchar("12")total=dim(aaa)
date=strsplit(aaa$DATE[1],"-")
month=date[[1]][2]
year=date[[1]][1]
mean.month=c()
month.1=c()
year.1=c()
count=1
s=numeric()
for(i in 1:120){
date=strsplit(aaa$DATE[i],"-")
while((date[[1]][1]!=year) || (date[[1]][2]!=month)){
month.1[count]=month
year.1[count]=year
if(month!="12") {
month=as.character(as.numeric(month)+1)
if(nchar(month)==1) month=paste0("0",month)
} else{
year=as.character(as.numeric(year)+1)
month="01"
}
if(length(s)>0){
mean.month[count]=mean(s)
} else{
mean.month[count]=0
}
s=numeric()
count=count+1
}
if(date[[1]][1]==year&date[[1]][2]==month){
if(is.na(aaa$PRCP[i])==F){
s=c(s,aaa$PRCP[i])
}
}
}
final1=data.frame(mean.month,year.1,month.1)
final1
total=dim(aaa)
date=strsplit(aaa$DATE[1],"-")
month=date[[1]][2]
year=date[[1]][1]
mean.month=c()
month.1=c()
year.1=c()
count=1
s=numeric()
for(i in 1:150){
date=strsplit(aaa$DATE[i],"-")
while((date[[1]][1]!=year) || (date[[1]][2]!=month)){
month.1[count]=month
year.1[count]=year
if(month!="12") {
month=as.character(as.numeric(month)+1)
if(nchar(month)==1) month=paste0("0",month)
} else{
year=as.character(as.numeric(year)+1)
month="01"
}
if(length(s)>0){
mean.month[count]=mean(s)
} else{
mean.month[count]=0
}
s=numeric()
count=count+1
}
if(date[[1]][1]==year&date[[1]][2]==month){
if(is.na(aaa$PRCP[i])==F){
s=c(s,aaa$PRCP[i])
}
}
}
final1=data.frame(mean.month,year.1,month.1)
final1
total=dim(aaa)
date=strsplit(aaa$DATE[1],"-")
month=date[[1]][2]
year=date[[1]][1]
mean.month=c()
month.1=c()
year.1=c()
count=1
s=numeric()
for(i in 1:180){
date=strsplit(aaa$DATE[i],"-")
while((date[[1]][1]!=year) || (date[[1]][2]!=month)){
month.1[count]=month
year.1[count]=year
if(month!="12") {
month=as.character(as.numeric(month)+1)
if(nchar(month)==1) month=paste0("0",month)
} else{
year=as.character(as.numeric(year)+1)
month="01"
}
if(length(s)>0){
mean.month[count]=mean(s)
} else{
mean.month[count]=0
}
s=numeric()
count=count+1
}
if(date[[1]][1]==year&date[[1]][2]==month){
if(is.na(aaa$PRCP[i])==F){
s=c(s,aaa$PRCP[i])
}
}
}
final1=data.frame(mean.month,year.1,month.1)
final1
total=dim(aaa)
date=strsplit(aaa$DATE[1],"-")
month=date[[1]][2]
year=date[[1]][1]
mean.month=c()
month.1=c()
year.1=c()
count=1
s=numeric()
for(i in 1:total[1]){
date=strsplit(aaa$DATE[i],"-")
while((date[[1]][1]!=year) || (date[[1]][2]!=month)){
month.1[count]=month
year.1[count]=year
if(month!="12") {
month=as.character(as.numeric(month)+1)
if(nchar(month)==1) month=paste0("0",month)
} else{
year=as.character(as.numeric(year)+1)
month="01"
}
if(length(s)>0){
mean.month[count]=mean(s)
} else{
mean.month[count]=0
}
s=numeric()
count=count+1
}
if(date[[1]][1]==year&date[[1]][2]==month){
if(is.na(aaa$PRCP[i])==F){
s=c(s,aaa$PRCP[i])
}
}
}
final1=data.frame(mean.month,year.1,month.1)
final1
aaa
tail(aaa)
total=dim(aaa)
date=strsplit(aaa$DATE[1],"-")
month=date[[1]][2]
year=date[[1]][1]
mean.month=c()
month.1=c()
year.1=c()
count=1
s=numeric()
for(i in 1:total[1]){
date=strsplit(aaa$DATE[i],"-")
while((date[[1]][1]!=year) || (date[[1]][2]!=month)){
month.1[count]=month
year.1[count]=year
if(month!="12") {
month=as.character(as.numeric(month)+1)
if(nchar(month)==1) month=paste0("0",month)
} else{
year=as.character(as.numeric(year)+1)
month="01"
}
if(length(s)>0){
mean.month[count]=mean(s)
} else{
mean.month[count]=0
}
s=numeric()
count=count+1
}
if(date[[1]][1]==year&date[[1]][2]==month){
if(is.na(aaa$PRCP[i])==F){
s=c(s,aaa$PRCP[i])
}
}
}
#deal with the tail
if(length(s)>0){
mean.month[count]=mean(s)
month.1[count]=month
year.1[count]=year
}
final1=data.frame(mean.month,year.1,month.1)
fianl1
final1
data = read.csv('../data/CA00101C0ME.csv')
summary(data[,c(7,9,13,15)])
?mean
head(data)
is.character(data$DATE)
data$DATE=as.character(data$DATE)
data=read.csv("CA00101C0ME.csv")
data$DATE=as.character(data$DATE)
######要先清洗数据，看这个地方是不是有满足要求的时间格式
#####起始第一行，假设已经清理好了
total=dim(data)
date=strsplit(data$DATE,"-")
data
date
unique(date)
gsub("(1-9)-(1-9)-(1-9)","//1-//2",data$DATE)
gsub("(1-9)-(1-9)-(1-9)","//1-//2",data$DATE[1])
gsub("(1-9)-(1-9)-(1-9)","\\1-\\2",data$DATE[1])
substr(data$DATE[1])
substr(data$DATE[1],start = 1,stop=7)
date=substr(data$DATE,start=6,stop=7)
date
date=substr(data$DATE,start=1,stop=7)
date
date=unique(substr(data$DATE,start=1,stop=7))
date
data=read.csv("CA00101C0ME.csv")
data$DATE=as.character(data$DATE)
######要先清洗数据，看这个地方是不是有满足要求的时间格式
#####起始第一行，假设已经清理好了
all_date=substr(data$DATE,start=1,stop=7)
unique.date=unique()
length_month=length(unique.date)
meanmonth=zeros(1,length_month)
for(i in 1:length_month){
final1[i]=mean(data$PRCP[all_date==unique.date[i]],na.rm=T)
}
final1=data.frame(date,meanmonth)
data$DATE=as.character(data$DATE)
######要先清洗数据，看这个地方是不是有满足要求的时间格式
#####起始第一行，假设已经清理好了
all_date=substr(data$DATE,start=1,stop=7)
unique.date=unique(all_date)
length_month=length(unique.date)
meanmonth=zeros(1,length_month)
for(i in 1:length_month){
final1[i]=mean(data$PRCP[all_date==unique.date[i]],na.rm=T)
}
final1=data.frame(date,meanmonth)
meanmonth=rep(0,length_month)
for(i in 1:length_month){
final1[i]=mean(data$PRCP[all_date==unique.date[i]],na.rm=T)
}
final1=data.frame(date,meanmonth)
meanmonth=rep(0,length_month)
for(i in 1:length_month){
meanmonth[i]=mean(data$PRCP[all_date==unique.date[i]],na.rm=T)
}
final1=data.frame(date,meanmonth)
final1
# read in data
data = read.csv('../data/CA00101C0ME.csv')
summary(data[,c(7,9,13,15)])
# average over month
all_date=substr(data$DATE,start=1,stop=7)
unique.date=unique(all_date)
length_month=length(unique.date)
mean_month=rep(0,length_month)
for(i in 1:length_month){
mean_month[i]=mean(data$PRCP[all_date==unique.date[i]],na.rm=T)
}
final1=data.frame(date,mean_month)
ts.plot(final1$mean_month)
ts.plot(final1$mean_month,gpars = final1$date)
?ts.plot
ts.plot(final1$mean_month,gpars = liat(xlab=final1$date))
ts.plot(final1$mean_month,gpars = list(xlab=final1$date))
ts.plot(final1$mean_month,nxm=5)
tsplot(final1$mean_month,nxm=5)
tsplot(final1$mean_month)
library(astsa)
library(ggplot2)
install.packages("astsa")
library(astsa)
library(ggplot2)
tsplot(final1$mean_month)
tsplot(final1$mean_month,x)
tsplot(final1$mean_month,nxm=5)
tsplot(final1)
gtemp.df= data.frame(Time=final1$date, gtemp=final1$mean_month)
ggplot(data = gtemp.df, aes(x=Time, y=value, color=variable )  )             +
ylab('Temperature Deviations')                                 +
geom_line(aes(y=gtemp , col='Ocean Only'), size=1, alpha=.5)   +
theme(legend.position=c(.1,.85))
gtemp.df= data.frame(Time=final1$date, gtemp=final1$mean_month)
ggplot(data = gtemp.df, aes(x=Time, y=gtemp, color=variable )  )             +
ylab('Temperature Deviations')                                 +
geom_line(aes(y=gtemp , col='Ocean Only'), size=1, alpha=.5)   +
theme(legend.position=c(.1,.85))
gtemp.df= data.frame(Time=final1$date, gtemp=final1$mean_month)
ggplot(data = gtemp.df, aes(x=Time, y=gtemp )  )             +
ylab('Temperature Deviations')                                 +
theme(legend.position=c(.1,.85))
gtemp.df= data.frame(Time=final1$date, gtemp=final1$mean_month)
ggplot(data = gtemp.df, aes(x=Time, y=gtemp )  )             +
ylab('Temperature Deviations')+
geom_line(aes(y=gtemp ), size=1, alpha=.5)
gtemp.df= data.frame(Time=final1$date, gtemp=final1$mean_month)
ggplot(data = gtemp.df, aes(x=Time, y=value )  )             +
ylab('Temperature Deviations')+
geom_line(aes(y=gtemp ), size=1, alpha=.5)
plot(cmort, ylab=expression(M[~t]~~~~(Number~Buried)), xaxt="no", type='n')
grid(lty=1, col=gray(.9))
lines(cmort, col=rgb(0,0,.9))
text(1974, 132, 'Bad Year', col=rgb(.5,0,.5), cex=1.25)   # just for fun
arrows(1973.5, 130, 1973, 127, length=0.05,  angle=30, col=rgb(.5,0,.5))
plot(cmort, ylab=expression(M[~t]~~~~(Number~Buried)), xaxt="no", type='n')
grid(lty=1, col=gray(.9))
lines(cmort, col=rgb(0,0,.9))
text(1974, 132, 'Bad Year', col=rgb(.5,0,.5), cex=1.25)   # just for fun
arrows(1973.5, 130, 1973, 127, length=0.05,  angle=30, col=rgb(.5,0,.5))
gtemp.df= data.frame(Time=final1$date, gtemp=final1$mean_month)
ggplot(data = gtemp.df, aes(x=Time, y=value )  )             +
ylab('Temperature Deviations')+
geom_line(aes(y=gtemp ), size=1, alpha=.5)
autoplot(cbind(Mortality=cmort, Temperature=tempr, Particulates=part), xlab='Time', facets=FALSE)
autoplot(cbind(Mortality=final1), xlab='Time', facets=FALSE)
autoplot(cbind(Mortality=final1$mean_month), xlab='Time', facets=FALSE)
cmort
autoplot(cbind(Mortality=ts(final1)), xlab='Time', facets=FALSE)
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Time', facets=FALSE)
autoplot(Mortality=ts(final1$mean_month), xlab='Time', facets=FALSE)
autoplot(cbind(Mortality=ts(final1)), xlab='Time', facets=FALSE)
ts(final1)
ts1=ts(final1)
ts1
?ts
ts1=ts(final1,start = final1$date[1],end = final1$date[56])
ts1=ts(final1,start = final1$date[1],end = final1$date[1])
ts1=ts(final1,start = final1$date[1],end = final1$date[56])
ts1=ts(final1,start = final1$date[1])
ts1=ts(final1$mean_month)
ts1
autoplot(cbind(Mortality=ts1), xlab='Time', facets=FALSE)
autoplot(cbind(Mortality=ts1), xlab='Time')
autoplot(cbind(Mortality=ts1), xlab='Time',ylab = 'Year',series = final1$mean_month)
ccmort
cmort
ts1=ts(final1$mean_month,start = c(1,1),end=c(1,20))
autoplot(cbind(Mortality=ts1), xlab='Time',ylab = 'Year',series = final1$mean_month)
ts1=ts(final1$mean_month,start = c(1,1),end=c(1,56))
autoplot(cbind(Mortality=ts1), xlab='Time',ylab = 'Year',series = final1$mean_month)
autoplot(cbind(Mortality=ts1), xlab='Time',ylab = 'Year')
ts1=ts(final1$mean_month,start = c(substr(final1$date[1],start=1,stop=4),substr(final1$date[56],start=6,stop=7)),end=c(1,56))
ts1=ts(final1$mean_month,start = c(substr(final1$date[1],start=1,stop=4),substr(final1$date[56],start=6,stop=7)),end=c(substr(final1$date[56],start=1,stop=4),substr(final1$date[56],start=6,stop=7)),)
ts1=ts(final1$mean_month,start = c(as.numeric(substr(final1$date[1],start=1,stop=4)),as.numeric(substr(final1$date[56],start=6,stop=7))),end=c(as.numeric(substr(final1$date[56],start=1,stop=4)),as.numeric(substr(final1$date[56],start=6,stop=7))))
autoplot(cbind(Mortality=ts1), xlab='Time',ylab = 'Year')
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Time',ylab = 'month')
?autoplot
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Rain')
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Rain',col="green")
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Rain',col="blue")
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Rain',col="green")
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Rain')
#ts1=ts(final1$mean_month,start = c(as.numeric(substr(final1$date[1],start=1,stop=4)),
#                                   as.numeric(substr(final1$date[56],start=6,stop=7))),
#       end=c(as.numeric(substr(final1$date[56],start=1,stop=4)),as.numeric(substr(final1$date[56],start=6,stop=7))))
#autoplot(cbind(Mortality=ts1), xlab='Year',ylab = 'Rain')
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Precipitation (tenths of mm)')
png(file='examplets.png', width=600, height=320)
#ts1=ts(final1$mean_month,start = c(as.numeric(substr(final1$date[1],start=1,stop=4)),
#                                   as.numeric(substr(final1$date[56],start=6,stop=7))),
#       end=c(as.numeric(substr(final1$date[56],start=1,stop=4)),as.numeric(substr(final1$date[56],start=6,stop=7))))
#autoplot(cbind(Mortality=ts1), xlab='Year',ylab = 'Rain')
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Precipitation (tenths of mm)')
dev.off()
meanmonth=mean(data$PRCP[all_date==unique.date,na.rm=T)
meanmonth=mean(data$PRCP[all_date==unique.date],na.rm=T)
meanmonth
library(astsa)
library(ggplot2)
#quick version
data=read.csv("CA00101C0ME.csv")
data$DATE=as.character(data$DATE)
all_date=substr(data$DATE,start=1,stop=7)
unique.date=unique(all_date)
length_month=length(unique.date)
meanmonth=rep(0,length_month)
for(i in 1:length_month){
meanmonth[i]=mean(data$PRCP[all_date==unique.date[i]],na.rm=T)
}
dt = data.frame(A = 1:10, B = c(2,15,6,18,9,7,13,15,10,3), C = c('A','C','A','B','C','D','A','C','D','B'))
p = ggplot(dt, aes(x = A, y = B, color = C, group = factor(1))) +
geom_point(size = 3.8) +
geom_line(size = 0.8) +
geom_text(aes(label = B, vjust = 1.1, hjust = -0.5, angle = 45), show_guide = FALSE)   ## 添加点的数值
p
————————————————
版权声明：本文为CSDN博主「九茶」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/Bone_ACE/article/details/47427453
dt = data.frame(A = 1:10, B = c(2,15,6,18,9,7,13,15,10,3), C = c('A','C','A','B','C','D','A','C','D','B'))
p = ggplot(dt, aes(x = A, y = B, color = C, group = factor(1))) +
geom_point(size = 3.8) +
geom_line(size = 0.8) +
geom_text(aes(label = B, vjust = 1.1, hjust = -0.5, angle = 45), show_guide = FALSE)   ## 添加点的数值
p
dt = data.frame(A = 1:10, B = c(2,15,6,18,9,7,13,15,10,3), C = c('A','C','A','B','C','D','A','C','D','B'))
p = ggplot(dt, aes(x = A, y = B, color = C, group = factor(1))) +
geom_point(size = 3.8) +
geom_line(size = 0.8) +
geom_text(aes(label = B, vjust = 1.1, hjust = -0.5, angle = 45), show.legend =  FALSE)   ## 添加点的数值
p
dt = data.frame(A = final1$date, B = final1$mean_month )
p = ggplot(dt, aes(x = A, y = B, group = factor(1))) +
geom_point(size = 3.8) +
geom_line(size = 0.8) +
geom_text(aes(label = B, vjust = 1.1, hjust = -0.5, angle = 45), show.legend =  FALSE)   ## 添加点的数值
p
dt = data.frame(A = final1$date, B = final1$mean_month )
p = ggplot(dt, aes(x = A, y = B, group = factor(1))) +
geom_point(size = 3.8) +
geom_line(size = 0.8)
p
dt = data.frame(A = final1$date, B = final1$mean_month )
p = ggplot(dt, aes(x = A, y = B, group = factor(1))) +
geom_line(size = 0.8)
p
p = ggplot(dt, aes(x = A, y = B, group = factor(1))) +
+     geom_line(size = 0.8)
p
p = ggplot(dt, aes(x = A, y = B, group = factor(1))) +
geom_line(size = 0.8)
p
autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Precipitation (tenths of mm)')
data(kidney, package="KMsurv")
s1 <- survfit(Surv(time=time, event=delta) ~ type, data=kidney)
autoplot(s1)
library(survMisc)
?autoplot
p <- autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Precipitation (tenths of mm)')
p + coord_fixed() +
#  scale_y_continuous(breaks=seq(0, 420, 30)) +
scale_x_continuous(breaks=seq(0, 56, 12))
p + coord_fixed(ratio=1/2) +
scale_x_continuous(breaks=seq(0, 56, 12))
png(file='examplets.png', width=600, height=320)
#ts1=ts(final1$mean_month,start = c(as.numeric(substr(final1$date[1],start=1,stop=4)),
#                                   as.numeric(substr(final1$date[56],start=6,stop=7))),
#       end=c(as.numeric(substr(final1$date[56],start=1,stop=4)),as.numeric(substr(final1$date[56],start=6,stop=7))))
#autoplot(cbind(Mortality=ts1), xlab='Year',ylab = 'Rain')
p <- autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Precipitation (tenths of mm)')
#p + coord_fixed() +
#  scale_x_continuous(breaks=seq(0, 56, 12))
p + coord_fixed(ratio=1/2) +
scale_x_continuous(breaks=seq(0, 56, 12))
dev.off()
png(file='examplets.png', width=600, height=320)
#ts1=ts(final1$mean_month,start = c(as.numeric(substr(final1$date[1],start=1,stop=4)),
#                                   as.numeric(substr(final1$date[56],start=6,stop=7))),
#       end=c(as.numeric(substr(final1$date[56],start=1,stop=4)),as.numeric(substr(final1$date[56],start=6,stop=7))))
#autoplot(cbind(Mortality=ts1), xlab='Year',ylab = 'Rain')
p <- autoplot(cbind(Mortality=ts(final1$mean_month)), xlab='Month',ylab = 'Precipitation (tenths of mm)')
#p + coord_fixed() +
#  scale_x_continuous(breaks=seq(0, 56, 12))
p + coord_fixed(ratio=1/4) +
scale_x_continuous(breaks=seq(0, 56, 12))
dev.off()
